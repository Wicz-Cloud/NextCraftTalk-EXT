┌─────────────────────────────────────────────────────────────────┐
│                        NEXTCLOUD TALK                           │
│                       (Chat Interface)                          │
└───────────────────────────┬─────────────────────────────────────┘
                            │ Webhook POST
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                    FASTAPI BOT SERVICE                          │
│  ┌──────────────┐  ┌──────────────┐  ┌────────────────────┐     │
│  │   Webhook    │─▶│  Query       │─▶│  Response         │     │
│  │   Handler    │  │  Processor   │  │  Formatter         │     │
│  └──────────────┘  └──────┬───────┘  └────────────────────┘     │
└────────────────────────────┼────────────────────────────────────┘
                             │
                ┌────────────┴────────────┐
                ▼                         ▼
    ┌─────────────────────┐   ┌─────────────────────┐
    │   CACHE LAYER       │   │   RAG PIPELINE      │
    │   (SQLite)          │   │                     │
    │ - Common recipes    │   │  1. Query Embedding │
    │ - Fast lookup       │   │  2. Vector Search   │
    └─────────────────────┘   │  3. Context Retrieve│
                              │  4. LLM Generation  │
                              └──────┬──────────────┘
                                     │
                    ┌────────────────┼────────────────┐
                    ▼                ▼                ▼
        ┌──────────────────┐ ┌──────────────┐ ┌─────────────┐
        │  VECTOR DB       │ │  EMBEDDINGS  │ │ LLM (Ollama)│
        │  (ChromaDB)      │ │  (MiniLM)    │ │ Phi-3/Gemma │
        │                  │ │              │ │             │
        │ - Wiki chunks    │ │ - Local model│ │- Local API  │
        │ - Embeddings     │ │              │ │             │
        └──────────────────┘ └──────────────┘ └─────────────┘
                    ▲
                    │
        ┌───────────┴──────────┐
        │   X.AI API          │
        │  - Fetch wiki pages  │
        │  - Parse content     │
        │  - Chunk text        │
        │  - Build index       │
        └──────────────────────┘
                    ▲
                    │
            minecraft.wiki
